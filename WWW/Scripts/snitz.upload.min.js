function checkFileType(n){var i=n.name,t=n.type,r=i.substring(i.lastIndexOf(".")).toLowerCase(),u=window.SnitzVars.allowedfiles.split(",");return t.indexOf("compressed")>=0||t.indexOf("zip")>=0||t.indexOf("pdf")>=0?jQuery.inArray(r,u)==-1?!1:!0:!1}$(document).ready(function(){$("body").on("click","#submitUpload",function(){for(var n,f=$("#editorDiv"),e=f.find(".bbc-code-editor")[0].id,r="[file]",u="[/file]",o=new FormData,i=document.getElementById("fileInput"),t=0;t<i.files.length;t++){if(checkFileType(i.files[t]))o.append(i.files[t].name,i.files[t]);else return BootstrapDialog.alert({title:"Error ",message:"File type not allowed."}),!1;if(i.files[t].size>window.SnitzVars.MaxFileSize*1048576)return BootstrapDialog.alert({title:"Error ",message:"File is too large."}),!1}return n=new XMLHttpRequest,n.open("POST",window.SnitzVars.baseUrl+"Home/Upload"),n.send(o),n.onerror=function(n){BootstrapDialog.alert({title:"Error ",message:n.error})},n.onreadystatechange=function(){var t,i;n.readyState===4&&n.status===200&&(t=n.responseText.split("|"),t[0]==="error"?BootstrapDialog.alert({title:"Error ",message:"Error uploading"}):(i="",t[1].indexOf("image")>=0&&(r="[img]",u="[/img]"),t[1].indexOf("pdf")>=0&&(r="[pdf]",u="[/pdf]"),t.length===3&&(i=t[2].replace('"',""),r="[file "+i+"]"),e=f.find(".bbc-code-editor")[0].id,$("#"+e).insertAtCaret(r+t[0].replace('"',"")+u),$("#modal-container").modal("hide")))},!1});$(document).on("change",":file",function(){var n=$(this),i=n.get(0).files?n.get(0).files.length:1,t=n.val().replace(/\\/g,"/").replace(/.*\//,"");$("#Attached").val(t)})});