
@using System.Globalization
@using LangResources.Utility
@using SnitzConfig
@using SnitzCore.Filters
@using SnitzCore.Utility
@using WWW.Filters
@using WWW.Views.Helpers
@{
    //check the culture so we can set the page direction and language
    CultureInfo ci = SessionData.Get<CultureInfo>("Culture");
    string clang = ci.TwoLetterISOLanguageName;
    bool isRighToLeft = SessionData.Get<bool>("isRighToLeft");

}
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://ogp.me/ns/fb#" lang="@clang" dir="@(isRighToLeft ?  "rtl" : "ltr" )">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    @RenderSection("pageMeta", required: false)
    <title>@ViewBag.Title</title>
    <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <link rel="alternate" type="application/rss+xml" title="@ResourceManager.GetLocalisedString("tipForumRss", "Tooltip") @Html.Raw(Config.ForumTitle)" href="@Url.Action("Active","RssFeed")" />
    @Styles.Render("~/bundles/sitecss")

    @Styles.Render("~/Content/stylesheet.min.css")
    @Styles.Render("~" + Config.ThemeFolder() + "/snitz.min.css")
    @if (isRighToLeft)
    {
        <!-- Load the default rtl css file -->
        <link href="~/Content/bootstrap-rtl.min.css" rel="stylesheet">
        @Html.Raw(Config.ThemeCss("snitz-rtl.min.css"))
    }

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    @Scripts.Render("~/bundles/oldIEBrowsersSupport")
    <![endif]-->
    <script src="@Url.Action("Index","JavaScriptSettings")" type="text/javascript"></script>
    <script src="@Url.Action("Resources","JavaScriptSettings")" type="text/javascript"></script>

    @if (Config.TableExists("CAL_EVENTS") && ClassicConfig.GetIntValue("INTCALUPCOMINGEVENTS") == 1 && ClassicConfig.GetIntValue("INTCALPUBLIC") == 1)
    {
        @Styles.Render("~/Content/fullcalendar.min.css")
        @Html.Raw(Config.ThemeCss("fullcalendar.min.css"))
        if (isRighToLeft)
        {
            @Styles.Render("~/Content/fullcalendar-rtl.css")
        }
    }
    @RenderSection("styles", required: false)
    @Html.PageStyles()

    <style>
        .navbar-brand {
            padding: 10px;
            padding-left: 40px;
        }
    </style>
</head>
<body id="page-top" onload="setStyleFromCookie();windowResize();">
    <!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <span class="navbar-brand form-inline">@ViewBag.Title</span>
            </div>
        </div><iframe id="fake" src="about:blank"></iframe>
    </div>
    <div id="resizeDiv" class="container-fluid page-content">


        <!-- Begin page content -->
        <div class="container-fluid">
            <noscript>
                <div class="alert">
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                    <strong>Warning!</strong> Please enable JavaScript in your browser!
                </div>
            </noscript>
            <div id="main-content" class="col-xs-12">
                @RenderBody()
            </div>
        </div>

        <!-- Begin page Footer -->
        <footer class="footer">
            <div class="container">
                <p class="text-muted flip text-right">&copy; @Html.Raw(String.Format(ClassicConfig.Copyright, DateTime.UtcNow.Year))</p>
                <p class="text-muted text-center small">@Html.Raw(ClassicConfig.PoweredBy)</p>
            </div>
        </footer>
    </div>
    <!-- Modal -->
    <input type="hidden" id="displayname" value="@HttpContext.Current.Session.SessionID" />
    <!-- Common scripts -->
    @Scripts.Render("~/bundles/corejs")

    <!-- language specific scripts -->
    @if (clang == "fa")
    {
        @Scripts.Render("~/bundles/Persian")
    }

    @if (clang == "nb" || clang == "nn" || clang == "no")
    {
        @Scripts.Render("~/Scripts/timeago/timeago.no.js")
    }
    else if (clang != "en")
    {
        @Scripts.Render("~/Scripts/timeago/timeago." + clang + ".js")
    }
    @Scripts.Render("~/bundles/Snitzjs")
    <script src="https://cdn.jsdelivr.net/npm/lazyload@2.0.0-rc.2/lazyload.js"></script>

    <script type="text/javascript">
    var SnitzVars = SnitzVars || {

    }
    SnitzVars.erpop = '@(TempData["errorpopup"] != null)';
    SnitzVars.pending ="@ViewBag.PendingMembers";
    SnitzVars.errMsg = '@ViewBag.Error';
    SnitzVars.successMsg = '@ViewBag.Success';
    tempScrollTop = sessionStorage.getItem('scrollTop');

    function refreshlazyload(){

        lazyload();
    };

    $(document).ready(function () {
        lazyload();
        $(".fig-caption").each(function () {
            var test = $(this);
            $.ajax({
                url: SnitzVars.baseUrl + "PhotoAlbum/GetCaption/" + $(this).data("id"),
                type: "GET",
                success: function (data) {
                    //alert(data); // the View
                    test.html(data);
                }
            });
        });

        if (SnitzVars.erpop==='True') {
            $('#application-error-div').modal('show');
        }
        /*show popup error message*/

        if (SnitzVars.errMsg.length > 1) {
            errorDlg('@ViewBag.ErrTitle', SnitzVars.errMsg);
        }

        /*show pending members*/
        if (SnitzVars.pending.length > 1 && SnitzVars.pending === 'True') {
            pendingMemberShow('@ResourceManager.GetLocalisedString("mnuAdminPending", "labels")');
        }

        if ('@ViewBag.Prompt'.length > 1) {
            BootstrapDialog.prompt({
                type: BootstrapDialog.TYPE_WARNING,
                title: "@ViewBag.PromptTitle",
                message: $('<span>No Job server found.<br/>Reset the AppPool?</span>'),
                callback: function (result) {
                    // result will be true if button was clicked, it will be false if users close the dialog directly.
                    if (result) {
                        $.ajax({
                            async: true,
                            type: "POST",
                            url: window.SnitzVars.baseUrl + "Admin/ResetApplication",
                            data: { userName: window.SnitzVars.userName },
                            cache: false,
                            success: function () { return false; }

                        });
                    }
                }

            });
        }
    });
    </script>
    <!-- main script section for pages -->
    @RenderSection("scripts", required: false)
    @Html.PageScripts()
    <script>

        var windowResize = function () {
            var maxheight = screen.availHeight * 95 / 100;
            var width = Math.min(screen.availWidth * 95 / 100, 800);
            var height = document.getElementById("resizeDiv").offsetHeight;

            window.resizeTo(width, Math.min(height + 160, maxheight));
        }


    </script>
</body>
</html>
